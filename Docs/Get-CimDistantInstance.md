# Get-CimDistantInstance

## SYNOPSIS

Returns one or more CIM instances distantly associated with the source along the specified path.

## SYNTAX

```PowerShell
Get-CimDistantInstance [-InputObject] <CimInstance>  
    [[-PathToInstance] <String>] [-KeyOnly]  
    [-Delimiter <Char>] [<CommonParameters>]
```

## DESCRIPTION

Returns one or more CIM instances distantly associated with the source along the specified path.  
Paths can be generated by [Find-CimAssociatedInstance](https://github.com/ejsiron/Poshery/blob/master/Docs/Find-CimAssociatedInstance.md).

## EXAMPLE

```PowerShell
PS C:\> $VMHost = (Get-CimInstance -Namespace root/virtualization/v2 -ClassName Msvm_ComputerSystem)[0]
PS C:\> $VMHost | Get-CimDistantInstance.ps1 -PathToInstance 'Msvm_LANEndpoint/Msvm_LANEndpoint/Msvm_EthernetSwitchPort'
```

On a Hyper-V host, loads the management operating system instance, then walks the indicated path to find all related instances of Msvm_EthernetSwitchPort.

## PARAMETERS

### -InputObject

The source CIM instance.

```yaml
Type                         Microsoft.Management.Infrastructure.CimInstance
Required?                    true
Position?                    `
Default value
Accept pipeline input?       true (ByValue)
Accept wildcard characters?  false
```

### PathToInstance

The path to the desired final instance name.  
The path is composed of the intermediary and final CIM class names, separated by the value of -Delimiter.  
Do not include the class name of the source instance.  
If empty or any component of the path is not found, returns nothing.

```yaml
Type                         String
Required?                    false
Position?                    3
Default value                [String]::Empty
Accept pipeline input?       false
Accept wildcard characters?  false
```

### -KeyOnly

If set, will only retrieve the key properties of the final instance(s).

```yaml
Type                         SwitchParameter
Required?                    false
Position?                    named
Default value                False
Accept pipeline input?       false
Accept wildcard characters?  false
```

### -Delimiter

The character that -PathToInstance uses as a delimiter. Defaults to /

```yaml
Type                         Char
Required?                    false
Position?                    named
Default value                /
Accept pipeline input?       false
Accept wildcard characters?  false
```

This cmdlet supports the common parameters: Verbose, Debug,
ErrorAction, ErrorVariable, WarningAction, WarningVariable,
OutBuffer, PipelineVariable, and OutVariable. For more information, see
[about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

- **Microsoft.Management.Infrastructure.CimInstance**
- **String**

## OUTPUTS

Microsoft.Management.Infrastructure.CimInstance[]

## NOTES

Author: Eric Siron  
First published December 12, 2018  
Released under MIT license

## RELATED LINKS
- [Get-CimInstance](https://docs.microsoft.com/en-us/powershell/module/cimcmdlets/get-ciminstance)
- [Find-CimAssociatedInstance](https://github.com/ejsiron/Poshery/blob/master/Docs/Find-CimAssociatedInstance.md)